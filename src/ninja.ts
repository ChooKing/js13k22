import {Entity} from "./entity";
import {Game} from "./game";
import {Paths} from "./Paths";
import {Point} from "./types";
const c=[
    {r:1,g:1,b:0},
    {r:202,g:190,b:160},
    {r:18,g:18,b:18},
    {r:235,g:235,b:235},
    {r:241,g:208,b:103},
    {r:65,g:62,b:51},
    {r:86,g:84,b:79},
    {r:192,g:181,b:154}
];
export class Ninja extends Entity{
    static w = 152;
    static h = 84;
    f: boolean;
    lt: number;//last update time
    core: Paths;
    thighL: Paths;
    armL:Paths;
    sword: Paths;
    swHand: Paths;
    armR: Paths;
    thighR: Paths;
    shinR: Paths;
    shinL: Paths;
    footR: Paths;
    footL: Paths;
    paths: Paths[];
    cols: Point[];
    onCollide?: ()=>void;
    constructor(x: number, y: number, col: Point[]) {
        super(x, y);
        this.xy={x:x, y:y};
        this.cols=col;
        this.f = false;
        this.lt = 0;
        this.thighL=new Paths([["M127.011,337.874c16.584,-3.609 -13.97,-49.943 -25.727,-67.854c-6.784,-10.334 -18.324,-15.071 -25.754,-10.572c-7.431,4.499 -7.956,16.541 -1.172,26.875c11.757,17.911 34.561,55.489 52.653,51.551Z", c[2]]]);
        this.armL=new Paths([
            ["M134.044,182.894c7.741,-8.178 -35.347,-23.924 -51.971,-30.03c-9.592,-3.524 -18.922,-2.049 -20.822,3.291c-1.901,5.34 4.344,12.536 13.935,16.059c16.625,6.107 50.413,19.601 58.858,10.68Z",c[2]],
            ["M91.043,200.041c6.202,6.626 11.624,-4.717 35.661,-5.105c6.595,-0.107 12.405,-7.261 10.717,-12.112c-1.688,-4.851 -8.02,-6.948 -14.131,-4.679c-10.592,3.932 -39.385,14.268 -32.247,21.896Z",c[2]]
        ]);
        this.core=new Paths([
            ["M60.845,136.272c-0,-0 21.344,9.728 30.825,2.068c13.541,-10.939 7.094,-27.531 -3.527,-44.663c-10.782,-17.39 -33.406,-5.264 -33.406,-5.264c-18.785,7.441 -15.69,41.83 6.108,47.859Z",c[0]],
            ["M89.922,97.246c-3.193,-1.701 -13.29,1.114 -15.417,3.705c-1.887,2.298 0.366,11.342 3.198,12.872c3.291,1.779 16.629,1.946 18.756,-0.645c1.888,-2.299 -3.704,-14.424 -6.537,-15.932Z",c[1]],
            ["M83.86,104.164c1.169,-0.196 2.459,1.018 2.881,2.709c0.421,1.692 -0.186,3.224 -1.355,3.42c-1.168,0.196 -2.459,-1.018 -2.88,-2.709c-0.421,-1.692 0.186,-3.224 1.354,-3.42Z",c[0]],
            ["M87.837,101.992c-0.677,-1.617 -3.309,-2.342 -5.872,-1.618c-2.563,0.724 -4.093,2.625 -3.415,4.242c0.88,-0.791 2.423,-1.668 4.275,-2.191c1.853,-0.523 3.725,-0.612 5.012,-0.433Z",c[0]],
            ["M58.699,145.319c-10.597,4.158 -19.162,22.996 -11.921,41.636c18.508,47.644 -16.055,108.138 38.047,92.278c15.984,-4.685 9.152,-60.778 3.817,-100.294c-1.68,-12.443 -6.933,-22.811 -13.315,-28.83l3.46,-16.827l-16.845,-3.731l-3.243,15.768Z",c[0]]
        ]);
        this.sword=new Paths([
            ["M37.239,0.5l9.074,7.48c0,-0 17.89,50.615 24.014,77.075c6.147,26.561 12.871,82.286 12.871,82.286l-6.898,1.72c0,-0 -6.396,-55.004 -12.624,-81.882c-6.511,-28.094 -26.437,-86.679 -26.437,-86.679Z",c[3]]
        ])
        this.swHand=new Paths([
            ["M74.097,167.556l10.758,-1.009l0.535,5.006l-10.758,1.009l-0.535,-5.006Z",c[4]],
            ["M73.279,172.825l13.76,-1.29l0.33,3.085l-13.76,1.29l-0.33,-3.085Z",c[5]],
            ["M75.591,175.942l9.314,-0.874l3.536,33.071l-9.314,0.873l-3.536,-33.07Z",c[0]],
            ["M82.161,193.397l-4.287,1.032l4.42,0.216l4.287,-1.032l-4.42,-0.216Z",c[0]],
            ["M81.892,190.887l-4.286,1.032l4.42,0.216l4.286,-1.032l-4.42,-0.216Z",c[0]],
            ["M86.385,194.625c-0,-0 -8.348,0.738 -9.947,1.384c-0.651,0.262 -0.35,2.405 0.348,2.478c1.296,0.137 5.11,-0.099 7.469,-0.635c-2.827,0.26 -6.457,1.096 -7.711,1.569c-0.724,0.273 -0.423,2.415 0.348,2.478c1.354,0.111 6.447,-0.377 9.213,-0.914l0.036,0.203c-2.845,0.274 -7.638,1.17 -8.874,1.636c-0.724,0.273 -0.423,2.416 0.348,2.479c1.334,0.109 5.299,-0.191 8.091,-0.719c-1.954,-0.101 -6.262,0.735 -7.698,1.237c-0.715,0.249 -0.452,2.117 0.303,2.16c1.803,0.103 8.694,-0.389 10.249,-1.816c0.664,-0.038 5.936,-3.802 5.603,-5.337l-1.464,-4.392c-0.334,-1.536 -2.523,-2.131 -2.523,-2.131c-0.828,-0.958 -3.512,-2.479 -3.791,0.32Z",c[7]]
        ]);
        this.armR=new Paths([
            ["M16.828,202.28c4.944,12.475 34.728,-13.158 46.248,-23.026c6.647,-5.693 8.528,-14.737 4.197,-20.183c-4.33,-5.446 -13.243,-5.245 -19.89,0.449c-11.52,9.868 -35.949,29.149 -30.555,42.76Z",c[2]],
            ["M73.943,184.924c-7.381,-7.352 -13.063,2.972 -43.28,1.557c-8.29,-0.388 -16.728,7.247 -15.389,12.858c1.339,5.611 8.946,8.468 16.976,6.376c13.919,-3.625 48.854,-13.656 41.693,-20.791Z",c[2]],
            ["M76.334,179.119c0,-0 7.473,-1.301 9.191,-1.142c0.698,0.065 1.025,2.203 0.378,2.474c-1.202,0.503 -4.923,1.373 -7.337,1.537c2.783,-0.563 6.5,-0.805 7.837,-0.712c0.772,0.053 1.099,2.192 0.379,2.474c-1.265,0.495 -6.284,1.49 -9.088,1.77l0.024,0.205c2.804,-0.554 7.652,-1.073 8.971,-0.982c0.771,0.054 1.099,2.192 0.378,2.474c-1.247,0.488 -5.131,1.34 -7.957,1.636c1.843,-0.658 6.209,-1.095 7.729,-1.027c0.756,0.034 1.042,1.898 0.33,2.156c-1.696,0.617 -8.439,2.126 -10.338,1.206c-0.647,0.154 -4.991,-0.355 -5.112,-1.922l-1.647,-6.209c-0.122,-1.567 1.804,-2.766 1.804,-2.766c0.518,-1.155 3.387,-3.772 4.458,-1.172Z",c[7]]
        ]);
        this.thighR=new Paths([
            ["M54.753,351.453c22.92,2.52 17.247,-49.121 28.713,-67.668c6.884,-11.135 -5.523,-23.738 -16.049,-25.561c-10.527,-1.823 -28.384,8.062 -22.6,27.011c6.39,20.935 -12.461,63.756 9.936,66.218Z",c[2]]
        ]);
        this.shinR=new Paths([
            ["M8.638,408.798c15.519,1.86 11.507,-15.095 46.404,-40.479c9.573,-6.964 11.301,-23.288 4.214,-28.545c-7.086,-5.258 -18.367,-1.745 -25.177,7.84c-11.804,16.611 -40.501,59.379 -25.441,61.184Z",c[2]]
        ]);
        this.shinL=new Paths([
            ["M148.977,402.934c-13.705,-3.159 -6.517,-17.511 -30.792,-51.837c-6.659,-9.417 -4.527,-24.99 2.707,-27.606c7.233,-2.617 16.119,4.159 19.832,15.122c6.434,19 21.552,67.386 8.253,64.321Z",c[2]]
        ]);
        this.footL=new Paths([
            ["M138.884,406.802c0.303,4.552 0.838,13.505 12.92,10.9c18.471,-3.983 22.579,11.827 36.248,-6.048c5,-6.539 -21.122,-1.554 -32.945,-16.396c-2.935,-3.685 -8.462,-3.761 -11.248,-1.838l-4.975,13.382Z",c[0]]
        ])
        this.footR=new Paths([
            ["M0.003,412.678c-0.027,4.561 -0.141,13.529 12.097,11.806c18.711,-2.636 21.665,13.43 36.591,-3.409c5.46,-6.161 -20.954,-3.078 -31.672,-18.738c-2.661,-3.887 -8.168,-4.363 -11.086,-2.646l-5.93,12.987Z",c[0]]
        ]);
        this.paths=Array();
        this.paths.push(this.armL);
        this.paths.push(this.core);
        this.paths.push(this.sword);
        this.paths.push(this.swHand);
        this.paths.push(this.thighL);
        this.paths.push(this.shinL);
        this.paths.push(this.footL);
        this.paths.push(this.armR);
        this.paths.push(this.thighR);
        this.paths.push(this.shinR);
        this.paths.push(this.footR);
    }
    draw(ctx: CanvasRenderingContext2D) {
        if(this.f){
            ctx.save();
            ctx.setTransform(-1,0,0,1,Ninja.w+(this.xy.x*2),0);

        }

        this.paths.forEach((p)=>{
            ctx.save();
            ctx.translate(this.xy.x,this.xy.y);
            p.draw();
            p.paths.forEach((i)=>{
                if(i[0]!==this.sword.paths[0][0]){
                    this.cols.forEach((c)=>{
                        if((this.onCollide)&&(this.collide(ctx,i[0],c.x,c.y))) this.onCollide();
                    });
                };
            });
            ctx.restore();
        });
        if(this.f) {
            ctx.restore();
        }
    }
    setCollider(c:()=>void){
        this.onCollide=c;
    }
    update(t: number){
        const dt = (t-this.lt)/1000;
        if(dt<1){
            this.xy.x+= this.f? -Game.s*dt : Game.s*dt;
        }

        this.lt = t;
    }
    /*
    collide(ctx: CanvasRenderingContext2D,x:number, y:number){
        let c=false
        this.paths.forEach((p)=>{
            p.paths.forEach((i)=>{
                if(i!==this.sword.paths[0]){
                    if(ctx.isPointInPath(i[0],x,y)) c=true;
                }
            });
        });
        return c;
    }

     */
}